<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Todo App Level 3</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container mt-5">

<h2 class="mb-4">Todo App - Level 3</h2>

<!-- FORM TẠO TASK -->
<form action="/add-task" method="POST" class="mb-4">

  <div class="mb-2">
    <input type="text" name="title" class="form-control" placeholder="Tên công việc" required>
  </div>

  <div class="mb-2">
    <label>Phân cho:</label>
    <select name="assignedTo" class="form-select" multiple required>
      <% users.forEach(user => { %>
        <option value="<%= user._id %>">
          <%= user.fullName %> (<%= user.role %>)
        </option>
      <% }) %>
    </select>
  </div>

  <button class="btn btn-primary">Tạo Task</button>
</form>

<hr>

<ul class="list-group">
  <% tasks.forEach(task => { %>
    <li class="list-group-item">

      <strong class="<%= task.status === 'done' ? 'text-decoration-line-through text-muted' : '' %>">
        <%= task.title %>
      </strong>

      <br>
      <small>
        Hoàn thành: <%= task.completedBy.length %> / <%= task.assignedTo.length %>
      </small>

      <div class="mt-2 d-flex gap-2">

        <% if (task.status === "pending") { %>
          <form action="/complete-task/<%= task._id %>" method="POST">
            <button class="btn btn-success btn-sm">Hoàn thành</button>
          </form>
        <% } %>

        <form action="/delete-task/<%= task._id %>" method="POST">
          <button class="btn btn-danger btn-sm">Xóa</button>
        </form>

      </div>

    </li>
  <% }) %>
</ul>

</body>
</html>